root@328c598cd59e:/app# nano abmil_assignment.py; tmux wait -S done
bash: nano: command not found
root@328c598cd59e:/app# # Completing the Attention_TanhSigmoidGating class\n# Implementing the __init__ and forward methods\n
root@328c598cd59e:/app# class Attention_TanhSigmoidGating(nn.Module):\n    def __init__(self, D, L):\n        super(Attention_TanhSigmoidGating, self).__init__(
)\n        self.tanhV = nn.Sequential(nn.Linear(D, L), nn.Tanh(), nn.Dropout())\n        self.sigmU = nn.Sequential(nn.Linear(D, L), nn.Sigmoid(), nn.Dropout())
\n        self.w = nn.Linear(L, 1)\n
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#     def forward(self, h):\n        # Compute attention weights\n        tanh_vh = self.tanhV(h)\n        sigm_uh = self.sigmU(h)\n
  a = self.w(tanh_vh * sigm_uh)\n        a = nn.functional.softmax(a, dim=1)\n        return a\n
bash: syntax error near unexpected token `('
root@328c598cd59e:/app# # Completing the ABMIL class\n# Implementing the __init__ and forward methods\n
root@328c598cd59e:/app# class ABMIL(nn.Module):\n    def __init__(self, input_dim, hidden_dim, n_classes):\n        super(ABMIL, self).__init__()\n        self.
inst_level_fc = nn.Sequential(nn.Linear(input_dim, hidden_dim), nn.ReLU(), nn.Dropout())\n        self.global_attn = Attention_TanhSigmoidGating(hidden_dim, hid
den_dim)\n        self.bag_level_classifier = nn.Linear(hidden_dim, n_classes)\n
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#     def forward(self, bags):\n        # Process each bag\n        h = self.inst_level_fc(bags)\n        a = self.global_attn(h)\n
 z = torch.sum(a * h, dim=1)\n        return self.bag_level_classifier(z)\n
bash: syntax error near unexpected token `('
root@328c598cd59e:/app# ctrl+x
bash: ctrl+x: command not found
root@328c598cd59e:/app# Y
bash: Y: command not found
root@328c598cd59e:/app# Enter; tmux wait -S done
bash: Enter: command not found
root@328c598cd59e:/app# python3 -m unittest basic_test.py; tmux wait -S done
E
======================================================================
ERROR: basic_test (unittest.loader._FailedTest.basic_test)
----------------------------------------------------------------------
ImportError: Failed to import test module: basic_test
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/unittest/loader.py", line 137, in loadTestsFromName
    module = __import__(module_name)
ModuleNotFoundError: No module named 'basic_test'


----------------------------------------------------------------------
Ran 1 test in 0.000s

FAILED (errors=1)
root@328c598cd59e:/app# vi abmil_assignment.py; tmux wait -S done
bash: vi: command not found
root@328c598cd59e:/app# i
bash: i: command not found
root@328c598cd59e:/app# # Completing the Attention_TanhSigmoidGating class
root@328c598cd59e:/app# class Attention_TanhSigmoidGating(nn.Module):
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#     def __init__(self, D, L):
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         super(Attention_TanhSigmoidGating, self).__init__()
bash: syntax error near unexpected token `Attention_TanhSigmoidGating,'
root@328c598cd59e:/app#         self.tanhV = nn.Sequential(nn.Linear(D, L), nn.Tanh(), nn.Dropout())
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         self.sigmU = nn.Sequential(nn.Linear(D, L), nn.Sigmoid(), nn.Dropout())
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         self.w = nn.Linear(L, 1)
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#
root@328c598cd59e:/app#     def forward(self, h):
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         # Compute attention weights
root@328c598cd59e:/app#         tanh_vh = self.tanhV(h)
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         sigm_uh = self.sigmU(h)
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         a = self.w(tanh_vh * sigm_uh)
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         a = nn.functional.softmax(a, dim=1)
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         return a
bash: return: a: numeric argument required
bash: return: can only `return' from a function or sourced script
root@328c598cd59e:/app#
root@328c598cd59e:/app# # Completing the ABMIL class
root@328c598cd59e:/app# class ABMIL(nn.Module):
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#     def __init__(self, input_dim, hidden_dim, n_classes):
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         super(ABMIL, self).__init__()
bash: syntax error near unexpected token `ABMIL,'
root@328c598cd59e:/app#         self.inst_level_fc = nn.Sequential(nn.Linear(input_dim, hidden_dim), nn.ReLU(), nn.Dropout())
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         self.global_attn = Attention_TanhSigmoidGating(hidden_dim, hidden_dim)
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         self.bag_level_classifier = nn.Linear(hidden_dim, n_classes)
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#
root@328c598cd59e:/app#     def forward(self, bags):
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         # Process each bag
root@328c598cd59e:/app#         h = self.inst_level_fc(bags)
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         a = self.global_attn(h)
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         z = torch.sum(a * h, dim=1)
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         return self.bag_level_classifier(z)
bash: syntax error near unexpected token `('
root@328c598cd59e:/app# Esc
bash: Esc: command not found
root@328c598cd59e:/app# :wq; tmux wait -S done
bash: :wq: command not found
root@328c598cd59e:/app# python3 -m unittest discover; tmux wait -S done

----------------------------------------------------------------------
Ran 0 tests in 0.000s

NO TESTS RAN
root@328c598cd59e:/app# vi abmil_assignment.py; tmux wait -S done
bash: vi: command not found
root@328c598cd59e:/app# i
bash: i: command not found
root@328c598cd59e:/app# # Completing the Attention_TanhSigmoidGating class
root@328c598cd59e:/app# class Attention_TanhSigmoidGating(nn.Module):
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#     def __init__(self, D, L):
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         super(Attention_TanhSigmoidGating, self).__init__()
bash: syntax error near unexpected token `Attention_TanhSigmoidGating,'
root@328c598cd59e:/app#         self.tanhV = nn.Sequential(nn.Linear(D, L), nn.Tanh(), nn.Dropout())
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         self.sigmU = nn.Sequential(nn.Linear(D, L), nn.Sigmoid(), nn.Dropout())
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         self.w = nn.Linear(L, 1)
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#
root@328c598cd59e:/app#     def forward(self, h):
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         # Compute attention weights
root@328c598cd59e:/app#         tanh_vh = self.tanhV(h)
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         sigm_uh = self.sigmU(h)
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         a = self.w(tanh_vh * sigm_uh)
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         a = nn.functional.softmax(a, dim=1)
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         return a
bash: return: a: numeric argument required
bash: return: can only `return' from a function or sourced script
root@328c598cd59e:/app#
root@328c598cd59e:/app# # Completing the ABMIL class
root@328c598cd59e:/app# class ABMIL(nn.Module):
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#     def __init__(self, input_dim, hidden_dim, n_classes):
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         super(ABMIL, self).__init__()
bash: syntax error near unexpected token `ABMIL,'
root@328c598cd59e:/app#         self.inst_level_fc = nn.Sequential(nn.Linear(input_dim, hidden_dim), nn.ReLU(), nn.Dropout())
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         self.global_attn = Attention_TanhSigmoidGating(hidden_dim, hidden_dim)
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         self.bag_level_classifier = nn.Linear(hidden_dim, n_classes)
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#
root@328c598cd59e:/app#     def forward(self, bags):
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         # Process each bag
root@328c598cd59e:/app#         h = self.inst_level_fc(bags)
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         a = self.global_attn(h)
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         z = torch.sum(a * h, dim=1)
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         return self.bag_level_classifier(z)
bash: syntax error near unexpected token `('
root@328c598cd59e:/app# Esc
bash: Esc: command not found
root@328c598cd59e:/app# :wq; tmux wait -S done
bash: :wq: command not found
root@328c598cd59e:/app# python3 -m unittest discover -s .; tmux wait -S done

----------------------------------------------------------------------
Ran 0 tests in 0.000s

NO TESTS RAN
root@328c598cd59e:/app# vi abmil_assignment.py; tmux wait -S done
bash: vi: command not found
root@328c598cd59e:/app# i
bash: i: command not found
root@328c598cd59e:/app# # Completing the Attention_TanhSigmoidGating class
root@328c598cd59e:/app# import torch
bash: import: command not found
root@328c598cd59e:/app# import torch.nn as nn
bash: import: command not found
root@328c598cd59e:/app#
root@328c598cd59e:/app# class Attention_TanhSigmoidGating(nn.Module):
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#     def __init__(self, D, L):
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         super(Attention_TanhSigmoidGating, self).__init__()
bash: syntax error near unexpected token `Attention_TanhSigmoidGating,'
root@328c598cd59e:/app#         self.tanhV = nn.Sequential(nn.Linear(D, L), nn.Tanh(), nn.Dropout())
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         self.sigmU = nn.Sequential(nn.Linear(D, L), nn.Sigmoid(), nn.Dropout())
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         self.w = nn.Linear(L, 1)
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#
root@328c598cd59e:/app#     def forward(self, h):
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         # Compute attention weights
root@328c598cd59e:/app#         tanh_vh = self.tanhV(h)
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         sigm_uh = self.sigmU(h)
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         a = self.w(tanh_vh * sigm_uh)
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         a = nn.functional.softmax(a, dim=1)
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         return a
bash: return: a: numeric argument required
bash: return: can only `return' from a function or sourced script
root@328c598cd59e:/app#
root@328c598cd59e:/app# # Completing the ABMIL class
root@328c598cd59e:/app# class ABMIL(nn.Module):
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#     def __init__(self, input_dim, hidden_dim, n_classes):
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         super(ABMIL, self).__init__()
bash: syntax error near unexpected token `ABMIL,'
root@328c598cd59e:/app#         self.inst_level_fc = nn.Sequential(nn.Linear(input_dim, hidden_dim), nn.ReLU(), nn.Dropout())
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         self.global_attn = Attention_TanhSigmoidGating(hidden_dim, hidden_dim)
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         self.bag_level_classifier = nn.Linear(hidden_dim, n_classes)
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#
root@328c598cd59e:/app#     def forward(self, bags):
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         # Process each bag
root@328c598cd59e:/app#         h = self.inst_level_fc(bags)
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         a = self.global_attn(h)
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         z = torch.sum(a * h, dim=1)
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         return self.bag_level_classifier(z)
bash: syntax error near unexpected token `('
root@328c598cd59e:/app# Esc
bash: Esc: command not found
root@328c598cd59e:/app# :wq; tmux wait -S done
bash: :wq: command not found
root@328c598cd59e:/app# ls -la; tmux wait -S done
total 12
drwxr-xr-x 1 root root 4096 Jul 15 00:05 .
drwxr-xr-x 1 root root 4096 Jul 15 00:05 ..
-rw-r--r-- 1 root root 2928 Jul 14 23:22 abmil_assignment.py
root@328c598cd59e:/app# python3 -m unittest discover -s .; tmux wait -S done

----------------------------------------------------------------------
Ran 0 tests in 0.000s

NO TESTS RAN
root@328c598cd59e:/app# vi abmil_assignment.py; tmux wait -S done
bash: vi: command not found
root@328c598cd59e:/app# i
bash: i: command not found
root@328c598cd59e:/app# import torch
bash: import: command not found
root@328c598cd59e:/app# import torch.nn as nn
bash: import: command not found
root@328c598cd59e:/app#
root@328c598cd59e:/app# class Attention_TanhSigmoidGating(nn.Module):
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#     def __init__(self, D, L):
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         super(Attention_TanhSigmoidGating, self).__init__()
bash: syntax error near unexpected token `Attention_TanhSigmoidGating,'
root@328c598cd59e:/app#         self.tanhV = nn.Sequential(nn.Linear(D, L), nn.Tanh(), nn.Dropout())
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         self.sigmU = nn.Sequential(nn.Linear(D, L), nn.Sigmoid(), nn.Dropout())
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         self.w = nn.Linear(L, 1)
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#
root@328c598cd59e:/app#     def forward(self, h):
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         # Compute attention weights
root@328c598cd59e:/app#         tanh_vh = self.tanhV(h)
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         sigm_uh = self.sigmU(h)
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         a = self.w(tanh_vh * sigm_uh)
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         a = nn.functional.softmax(a, dim=1)
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         return a
bash: return: a: numeric argument required
bash: return: can only `return' from a function or sourced script
root@328c598cd59e:/app#
root@328c598cd59e:/app# # Completing the ABMIL class
root@328c598cd59e:/app# class ABMIL(nn.Module):
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#     def __init__(self, input_dim, hidden_dim, n_classes):
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         super(ABMIL, self).__init__()
bash: syntax error near unexpected token `ABMIL,'
root@328c598cd59e:/app#         self.inst_level_fc = nn.Sequential(nn.Linear(input_dim, hidden_dim), nn.ReLU(), nn.Dropout())
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         self.global_attn = Attention_TanhSigmoidGating(hidden_dim, hidden_dim)
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         self.bag_level_classifier = nn.Linear(hidden_dim, n_classes)
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#
root@328c598cd59e:/app#     def forward(self, bags):
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         # Process each bag
root@328c598cd59e:/app#         h = self.inst_level_fc(bags)
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         a = self.global_attn(h)
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         z = torch.sum(a * h, dim=1)
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         return self.bag_level_classifier(z)
bash: syntax error near unexpected token `('
root@328c598cd59e:/app# Esc
bash: Esc: command not found
root@328c598cd59e:/app# :wq; tmux wait -S done
bash: :wq: command not found
root@328c598cd59e:/app# touch test_abmil.py; tmux wait -S done
root@328c598cd59e:/app# vi test_abmil.py; tmux wait -S done
bash: vi: command not found
root@328c598cd59e:/app# i
bash: i: command not found
root@328c598cd59e:/app# import unittest
bash: import: command not found
root@328c598cd59e:/app# from abmil_assignment import ABMIL
bash: from: command not found
root@328c598cd59e:/app#
root@328c598cd59e:/app# class TestABMIL(unittest.TestCase):
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#     def test_forward(self):
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         model = ABMIL(input_dim=10, hidden_dim=5, n_classes=2)
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         bags = torch.rand(4, 10)  # Simulating 4 bags of 10 patches each
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         output = model(bags)
bash: syntax error near unexpected token `('
root@328c598cd59e:/app#         self.assertEqual(output.shape, (4, 2))  # Check output shape
bash: syntax error near unexpected token `output.shape,'
root@328c598cd59e:/app#
root@328c598cd59e:/app# if __name__ == '__main__':
>     unittest.main()Esc
bash: syntax error near unexpected token `Esc'
root@328c598cd59e:/app# :wq; tmux wait -S done
bash: :wq: command not found
root@328c598cd59e:/app# python3 -m unittest discover -s .; tmux wait -S done

----------------------------------------------------------------------
Ran 0 tests in 0.000s

NO TESTS RAN
root@328c598cd59e:/app# echo "import unittest" > test_abmil.py; tmux wait -S done
root@328c598cd59e:/app# echo "from abmil_assignment import ABMIL" >> test_abmil.py; tmux wait -S done
root@328c598cd59e:/app# echo "class TestABMIL(unittest.TestCase):" >> test_abmil.py; tmux wait -S done
root@328c598cd59e:/app# echo "    def test_forward(self):" >> test_abmil.py; tmux wait -S done
root@328c598cd59e:/app# echo "        model = ABMIL(input_dim=10, hidden_dim=5, n_classes=2)" >> test_abmil.py; tmux wait -S done
root@328c598cd59e:/app# echo "        bags = torch.rand(4, 10)  # Simulating 4 bags of 10 patches each" >> test_abmil.py; tmux wait -S done
root@328c598cd59e:/app# echo "        output = model(bags)" >> test_abmil.py; tmux wait -S done
root@328c598cd59e:/app# echo "        self.assertEqual(output.shape, (4, 2))  # Check output shape" >> test_abmil.py; tmux wait -S done
root@328c598cd59e:/app# echo "if __name__ == '__main__':" >> test_abmil.py; tmux wait -S done
root@328c598cd59e:/app# echo "    unittest.main()" >> test_abmil.py; tmux wait -S done
root@328c598cd59e:/app# python3 -m unittest discover -s .; tmux wait -S done
E
======================================================================
ERROR: test_forward (test_abmil.TestABMIL.test_forward)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/app/test_abmil.py", line 6, in test_forward
    bags = torch.rand(4, 10)  # Simulating 4 bags of 10 patches each
           ^^^^^
NameError: name 'torch' is not defined

----------------------------------------------------------------------
Ran 1 test in 0.001s

FAILED (errors=1)
root@328c598cd59e:/app# echo "import torch" >> test_abmil.py; tmux wait -S done
root@328c598cd59e:/app# python3 -m unittest discover -s .; tmux wait -S done
E
======================================================================
ERROR: test_forward (test_abmil.TestABMIL.test_forward)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/app/test_abmil.py", line 8, in test_forward
    self.assertEqual(output.shape, (4, 2))  # Check output shape
                     ^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'shape'

----------------------------------------------------------------------
Ran 1 test in 0.001s

FAILED (errors=1)
root@328c598cd59e:/app# echo "def forward(self, bags):" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "    print('Input bags shape:', bags.shape)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "    h = self.inst_level_fc(bags)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "    a = self.global_attn(h)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "    z = torch.sum(a * h, dim=1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "    print('Output z shape:', z.shape)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "    return self.bag_level_classifier(z)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# python3 -m unittest discover -s .; tmux wait -S done
E
======================================================================
ERROR: test_forward (test_abmil.TestABMIL.test_forward)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/app/test_abmil.py", line 8, in test_forward
    self.assertEqual(output.shape, (4, 2))  # Check output shape
                     ^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'shape'

----------------------------------------------------------------------
Ran 1 test in 0.002s

FAILED (errors=1)
root@328c598cd59e:/app# echo "def forward(self, bags):" > abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "    print('Input bags shape:', bags.shape)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "    h = self.inst_level_fc(bags)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "    print('Intermediate h shape:', h.shape)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "    a = self.global_attn(h)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "    print('Attention weights shape:', a.shape)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "    z = torch.sum(a * h, dim=1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "    print('Output z shape:', z.shape)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "    return self.bag_level_classifier(z)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# python3 -m unittest discover -s .; tmux wait -S done
E
======================================================================
ERROR: test_abmil (unittest.loader._FailedTest.test_abmil)
----------------------------------------------------------------------
ImportError: Failed to import test module: test_abmil
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/unittest/loader.py", line 396, in _find_test_path
    module = self._get_module_from_name(name)
  File "/usr/local/lib/python3.13/unittest/loader.py", line 339, in _get_module_from_name
    __import__(name)
    ~~~~~~~~~~^^^^^^
  File "/app/test_abmil.py", line 2, in <module>
    from abmil_assignment import ABMIL
ImportError: cannot import name 'ABMIL' from 'abmil_assignment' (/app/abmil_assignment.py)


----------------------------------------------------------------------
Ran 1 test in 0.000s

FAILED (errors=1)
root@328c598cd59e:/app# cat abmil_assignment.py; tmux wait -S done
def forward(self, bags):
    print('Input bags shape:', bags.shape)
    h = self.inst_level_fc(bags)
    print('Intermediate h shape:', h.shape)
    a = self.global_attn(h)
    print('Attention weights shape:', a.shape)
    z = torch.sum(a * h, dim=1)
    print('Output z shape:', z.shape)
    return self.bag_level_classifier(z)
root@328c598cd59e:/app# python3 -m unittest discover -s .; tmux wait -S done
E
======================================================================
ERROR: test_abmil (unittest.loader._FailedTest.test_abmil)
----------------------------------------------------------------------
ImportError: Failed to import test module: test_abmil
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/unittest/loader.py", line 396, in _find_test_path
    module = self._get_module_from_name(name)
  File "/usr/local/lib/python3.13/unittest/loader.py", line 339, in _get_module_from_name
    __import__(name)
    ~~~~~~~~~~^^^^^^
  File "/app/test_abmil.py", line 2, in <module>
    from abmil_assignment import ABMIL
ImportError: cannot import name 'ABMIL' from 'abmil_assignment' (/app/abmil_assignment.py)


----------------------------------------------------------------------
Ran 1 test in 0.000s

FAILED (errors=1)
root@328c598cd59e:/app# vi abmil_assignment.py; tmux wait -S done
bash: vi: command not found
root@328c598cd59e:/app# python3 -m unittest discover -s .; tmux wait -S done
E
======================================================================
ERROR: test_abmil (unittest.loader._FailedTest.test_abmil)
----------------------------------------------------------------------
ImportError: Failed to import test module: test_abmil
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/unittest/loader.py", line 396, in _find_test_path
    module = self._get_module_from_name(name)
  File "/usr/local/lib/python3.13/unittest/loader.py", line 339, in _get_module_from_name
    __import__(name)
    ~~~~~~~~~~^^^^^^
  File "/app/test_abmil.py", line 2, in <module>
    from abmil_assignment import ABMIL
ImportError: cannot import name 'ABMIL' from 'abmil_assignment' (/app/abmil_assignment.py)


----------------------------------------------------------------------
Ran 1 test in 0.000s

FAILED (errors=1)
root@328c598cd59e:/app# echo "import torch" > abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "import torch.nn as nn" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "class Attention_TanhSigmoidGating(nn.Module):" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "    def __init__(self, D, L):" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        super(Attention_TanhSigmoidGating, self).__init__()" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        self.tanhV = nn.Sequential(nn.Linear(D, L), nn.Tanh(), nn.Dropout())" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        self.sigmU = nn.Sequential(nn.Linear(D, L), nn.Sigmoid(), nn.Dropout())" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        self.w = nn.Linear(L, 1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "    def forward(self, h):" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        tanh_vh = self.tanhV(h)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        sigm_uh = self.sigmU(h)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        a = self.w(tanh_vh * sigm_uh)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        a = nn.functional.softmax(a, dim=1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        return a" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "class ABMIL(nn.Module):" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "    def __init__(self, input_dim, hidden_dim, n_classes):" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        super(ABMIL, self).__init__()" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        self.inst_level_fc = nn.Sequential(nn.Linear(input_dim, hidden_dim), nn.ReLU(), nn.Dropout())" >> abmil_assignment.py; tmu
x wait -S done
root@328c598cd59e:/app# echo "        self.global_attn = Attention_TanhSigmoidGating(hidden_dim, hidden_dim)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        self.bag_level_classifier = nn.Linear(hidden_dim, n_classes)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "    def forward(self, bags):" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        h = self.inst_level_fc(bags)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        a = self.global_attn(h)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        z = torch.sum(a * h, dim=1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        return self.bag_level_classifier(z)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# python3 -m unittest discover -s .; tmux wait -S done
E
======================================================================
ERROR: test_forward (test_abmil.TestABMIL.test_forward)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/app/test_abmil.py", line 7, in test_forward
    output = model(bags)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/app/abmil_assignment.py", line 25, in forward
    return self.bag_level_classifier(z)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (1x4 and 5x2)

----------------------------------------------------------------------
Ran 1 test in 0.094s

FAILED (errors=1)
root@328c598cd59e:/app# echo "print('Bags shape:', bags.shape)" >> test_abmil.py; tmux wait -S done
root@328c598cd59e:/app# echo "print('h shape:', h.shape)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "print('a shape:', a.shape)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "print('z shape:', z.shape)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# python3 -m unittest discover -s .; tmux wait -S done
E
======================================================================
ERROR: test_abmil (unittest.loader._FailedTest.test_abmil)
----------------------------------------------------------------------
ImportError: Failed to import test module: test_abmil
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/unittest/loader.py", line 396, in _find_test_path
    module = self._get_module_from_name(name)
  File "/usr/local/lib/python3.13/unittest/loader.py", line 339, in _get_module_from_name
    __import__(name)
    ~~~~~~~~~~^^^^^^
  File "/app/test_abmil.py", line 2, in <module>
    from abmil_assignment import ABMIL
  File "/app/abmil_assignment.py", line 26, in <module>
    print('h shape:', h.shape)
                      ^
NameError: name 'h' is not defined


----------------------------------------------------------------------
Ran 1 test in 0.000s

FAILED (errors=1)
root@328c598cd59e:/app# sed -i '/print("h shape:/d' abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# sed -i '/print("a shape:/d' abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# sed -i '/print("z shape:/d' abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        print('h shape:', h.shape)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        print('a shape:', a.shape)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        print('z shape:', z.shape)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# python3 -m unittest discover -s .; tmux wait -S done
E
======================================================================
ERROR: test_abmil (unittest.loader._FailedTest.test_abmil)
----------------------------------------------------------------------
ImportError: Failed to import test module: test_abmil
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/unittest/loader.py", line 396, in _find_test_path
    module = self._get_module_from_name(name)
  File "/usr/local/lib/python3.13/unittest/loader.py", line 339, in _get_module_from_name
    __import__(name)
    ~~~~~~~~~~^^^^^^
  File "/app/test_abmil.py", line 2, in <module>
    from abmil_assignment import ABMIL
  File "/app/abmil_assignment.py", line 29
    print('h shape:', h.shape)
IndentationError: unexpected indent


----------------------------------------------------------------------
Ran 1 test in 0.000s

FAILED (errors=1)
root@328c598cd59e:/app# sed -i 's/        print/    print/g' abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# sed -i 's/    print/        print/g' abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# python3 -m unittest discover -s .; tmux wait -S done
E
======================================================================
ERROR: test_abmil (unittest.loader._FailedTest.test_abmil)
----------------------------------------------------------------------
ImportError: Failed to import test module: test_abmil
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/unittest/loader.py", line 396, in _find_test_path
    module = self._get_module_from_name(name)
  File "/usr/local/lib/python3.13/unittest/loader.py", line 339, in _get_module_from_name
    __import__(name)
    ~~~~~~~~~~^^^^^^
  File "/app/test_abmil.py", line 2, in <module>
    from abmil_assignment import ABMIL
  File "/app/abmil_assignment.py", line 29
    print('h shape:', h.shape)
IndentationError: unexpected indent


----------------------------------------------------------------------
Ran 1 test in 0.000s

FAILED (errors=1)
root@328c598cd59e:/app# echo "# Correcting indentation and ensuring consistency" > abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "import torch" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "import torch.nn as nn" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "class Attention_TanhSigmoidGating(nn.Module):" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "    def __init__(self, D, L):" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        super(Attention_TanhSigmoidGating, self).__init__()" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        self.tanhV = nn.Sequential(nn.Linear(D, L), nn.Tanh(), nn.Dropout())" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        self.sigmU = nn.Sequential(nn.Linear(D, L), nn.Sigmoid(), nn.Dropout())" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        self.w = nn.Linear(L, 1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "    def forward(self, h):" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        tanh_vh = self.tanhV(h)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        sigm_uh = self.sigmU(h)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        a = self.w(tanh_vh * sigm_uh)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        a = nn.functional.softmax(a, dim=1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        return a" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "class ABMIL(nn.Module):" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "    def __init__(self, input_dim, hidden_dim, n_classes):" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        super(ABMIL, self).__init__()" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        self.inst_level_fc = nn.Sequential(nn.Linear(input_dim, hidden_dim), nn.ReLU(), nn.Dropout())" >> abmil_assignment.py; tmu
x wait -S done
root@328c598cd59e:/app# echo "        self.global_attn = Attention_TanhSigmoidGating(hidden_dim, hidden_dim)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        self.bag_level_classifier = nn.Linear(hidden_dim, n_classes)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "    def forward(self, bags):" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        h = self.inst_level_fc(bags)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        print('h shape:', h.shape)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        a = self.global_attn(h)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        print('a shape:', a.shape)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        z = torch.sum(a * h, dim=1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        print('z shape:', z.shape)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        return self.bag_level_classifier(z)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# python3 -m unittest discover -s .; tmux wait -S done
E
======================================================================
ERROR: test_abmil (unittest.loader._FailedTest.test_abmil)
----------------------------------------------------------------------
ImportError: Failed to import test module: test_abmil
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/unittest/loader.py", line 396, in _find_test_path
    module = self._get_module_from_name(name)
  File "/usr/local/lib/python3.13/unittest/loader.py", line 339, in _get_module_from_name
    __import__(name)
    ~~~~~~~~~~^^^^^^
  File "/app/test_abmil.py", line 12, in <module>
    print('Bags shape:', bags.shape)
                         ^^^^
NameError: name 'bags' is not defined


----------------------------------------------------------------------
Ran 1 test in 0.000s

FAILED (errors=1)
root@328c598cd59e:/app# sed -i '/print("Bags shape:/d' test_abmil.py; tmux wait -S done
root@328c598cd59e:/app# echo "        print('Bags shape:', bags.shape)" >> test_abmil.py; tmux wait -S done
root@328c598cd59e:/app# python3 -m unittest discover -s .; tmux wait -S done
E
======================================================================
ERROR: test_abmil (unittest.loader._FailedTest.test_abmil)
----------------------------------------------------------------------
ImportError: Failed to import test module: test_abmil
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/unittest/loader.py", line 396, in _find_test_path
    module = self._get_module_from_name(name)
  File "/usr/local/lib/python3.13/unittest/loader.py", line 339, in _get_module_from_name
    __import__(name)
    ~~~~~~~~~~^^^^^^
  File "/app/test_abmil.py", line 13
    print('Bags shape:', bags.shape)
IndentationError: unexpected indent


----------------------------------------------------------------------
Ran 1 test in 0.000s

FAILED (errors=1)
root@328c598cd59e:/app# sed -i '/print("Bags shape:/d' test_abmil.py; tmux wait -S done
root@328c598cd59e:/app# echo "        print('Bags shape:', bags.shape)" >> test_abmil.py; tmux wait -S done
root@328c598cd59e:/app# python3 -m unittest discover -s .; tmux wait -S done
E
======================================================================
ERROR: test_abmil (unittest.loader._FailedTest.test_abmil)
----------------------------------------------------------------------
ImportError: Failed to import test module: test_abmil
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/unittest/loader.py", line 396, in _find_test_path
    module = self._get_module_from_name(name)
  File "/usr/local/lib/python3.13/unittest/loader.py", line 339, in _get_module_from_name
    __import__(name)
    ~~~~~~~~~~^^^^^^
  File "/app/test_abmil.py", line 13
    print('Bags shape:', bags.shape)
IndentationError: unexpected indent


----------------------------------------------------------------------
Ran 1 test in 0.000s

FAILED (errors=1)
root@328c598cd59e:/app# cat test_abmil.py; tmux wait -S done
import unittest
from abmil_assignment import ABMIL
class TestABMIL(unittest.TestCase):
    def test_forward(self):
        model = ABMIL(input_dim=10, hidden_dim=5, n_classes=2)
        bags = torch.rand(4, 10)  # Simulating 4 bags of 10 patches each
        output = model(bags)
        self.assertEqual(output.shape, (4, 2))  # Check output shape
if __name__ == '__main__':
    unittest.main()
import torch
print('Bags shape:', bags.shape)
        print('Bags shape:', bags.shape)
        print('Bags shape:', bags.shape)
root@328c598cd59e:/app# python3 -m unittest discover -s .; tmux wait -S done
E
======================================================================
ERROR: test_abmil (unittest.loader._FailedTest.test_abmil)
----------------------------------------------------------------------
ImportError: Failed to import test module: test_abmil
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/unittest/loader.py", line 396, in _find_test_path
    module = self._get_module_from_name(name)
  File "/usr/local/lib/python3.13/unittest/loader.py", line 339, in _get_module_from_name
    __import__(name)
    ~~~~~~~~~~^^^^^^
  File "/app/test_abmil.py", line 13
    print('Bags shape:', bags.shape)
IndentationError: unexpected indent


----------------------------------------------------------------------
Ran 1 test in 0.000s

FAILED (errors=1)
root@328c598cd59e:/app# sed -i '/print("Bags shape:/d' test_abmil.py; tmux wait -S done
root@328c598cd59e:/app# echo "        print('Bags shape:', bags.shape)" >> test_abmil.py; tmux wait -S done
root@328c598cd59e:/app# python3 -m unittest discover -s .; tmux wait -S done
E
======================================================================
ERROR: test_abmil (unittest.loader._FailedTest.test_abmil)
----------------------------------------------------------------------
ImportError: Failed to import test module: test_abmil
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/unittest/loader.py", line 396, in _find_test_path
    module = self._get_module_from_name(name)
  File "/usr/local/lib/python3.13/unittest/loader.py", line 339, in _get_module_from_name
    __import__(name)
    ~~~~~~~~~~^^^^^^
  File "/app/test_abmil.py", line 13
    print('Bags shape:', bags.shape)
IndentationError: unexpected indent


----------------------------------------------------------------------
Ran 1 test in 0.000s

FAILED (errors=1)
root@328c598cd59e:/app# vi test_abmil.py; tmux wait -S done
bash: vi: command not found
root@328c598cd59e:/app# python3 -m unittest discover -s .; tmux wait -S done
E
======================================================================
ERROR: test_abmil (unittest.loader._FailedTest.test_abmil)
----------------------------------------------------------------------
ImportError: Failed to import test module: test_abmil
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/unittest/loader.py", line 396, in _find_test_path
    module = self._get_module_from_name(name)
  File "/usr/local/lib/python3.13/unittest/loader.py", line 339, in _get_module_from_name
    __import__(name)
    ~~~~~~~~~~^^^^^^
  File "/app/test_abmil.py", line 13
    print('Bags shape:', bags.shape)
IndentationError: unexpected indent


----------------------------------------------------------------------
Ran 1 test in 0.000s

FAILED (errors=1)
root@328c598cd59e:/app# echo "import unittest" > test_abmil.py; tmux wait -S done
root@328c598cd59e:/app# echo "import torch" >> test_abmil.py; tmux wait -S done
root@328c598cd59e:/app# echo "from abmil_assignment import ABMIL" >> test_abmil.py; tmux wait -S done
root@328c598cd59e:/app# echo "class TestABMIL(unittest.TestCase):" >> test_abmil.py; tmux wait -S done
root@328c598cd59e:/app# echo "    def test_forward(self):" >> test_abmil.py; tmux wait -S done
root@328c598cd59e:/app# echo "        model = ABMIL(input_dim=10, hidden_dim=5, n_classes=2)" >> test_abmil.py; tmux wait -S done
root@328c598cd59e:/app# echo "        bags = torch.rand(4, 10)  # Simulating 4 bags of 10 patches each" >> test_abmil.py; tmux wait -S done
root@328c598cd59e:/app# echo "        print('Bags shape:', bags.shape)" >> test_abmil.py; tmux wait -S done
root@328c598cd59e:/app# echo "        output = model(bags)" >> test_abmil.py; tmux wait -S done
root@328c598cd59e:/app# echo "        self.assertEqual(output.shape, (4, 2))  # Check output shape" >> test_abmil.py; tmux wait -S done
root@328c598cd59e:/app# echo "if __name__ == '__main__':" >> test_abmil.py; tmux wait -S done
root@328c598cd59e:/app# echo "    unittest.main()" >> test_abmil.py; tmux wait -S done
root@328c598cd59e:/app# python3 -m unittest discover -s .; tmux wait -S done
Bags shape: torch.Size([4, 10])
h shape: torch.Size([4, 5])
a shape: torch.Size([4, 1])
z shape: torch.Size([4])
E
======================================================================
ERROR: test_forward (test_abmil.TestABMIL.test_forward)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/app/test_abmil.py", line 9, in test_forward
    output = model(bags)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/app/abmil_assignment.py", line 29, in forward
    return self.bag_level_classifier(z)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (1x4 and 5x2)

----------------------------------------------------------------------
Ran 1 test in 0.008s

FAILED (errors=1)
root@328c598cd59e:/app# echo "        z = z.view(z.size(0), -1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# python3 -m unittest discover -s .; tmux wait -S done
Bags shape: torch.Size([4, 10])
h shape: torch.Size([4, 5])
a shape: torch.Size([4, 1])
z shape: torch.Size([4])
E
======================================================================
ERROR: test_forward (test_abmil.TestABMIL.test_forward)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/app/test_abmil.py", line 9, in test_forward
    output = model(bags)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/app/abmil_assignment.py", line 29, in forward
    return self.bag_level_classifier(z)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (1x4 and 5x2)

----------------------------------------------------------------------
Ran 1 test in 0.007s

FAILED (errors=1)
root@328c598cd59e:/app# echo "        z = torch.sum(a * h, dim=1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        z = z.view(z.size(0), -1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# python3 -m unittest discover -s .; tmux wait -S done
Bags shape: torch.Size([4, 10])
h shape: torch.Size([4, 5])
a shape: torch.Size([4, 1])
z shape: torch.Size([4])
E
======================================================================
ERROR: test_forward (test_abmil.TestABMIL.test_forward)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/app/test_abmil.py", line 9, in test_forward
    output = model(bags)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/app/abmil_assignment.py", line 29, in forward
    return self.bag_level_classifier(z)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (1x4 and 5x2)

----------------------------------------------------------------------
Ran 1 test in 0.007s

FAILED (errors=1)
root@328c598cd59e:/app# echo "        a = a.view(a.size(0), -1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        z = torch.sum(a * h, dim=1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        z = z.view(z.size(0), -1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# python3 -m unittest discover -s .; tmux wait -S done
Bags shape: torch.Size([4, 10])
h shape: torch.Size([4, 5])
a shape: torch.Size([4, 1])
z shape: torch.Size([4])
E
======================================================================
ERROR: test_forward (test_abmil.TestABMIL.test_forward)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/app/test_abmil.py", line 9, in test_forward
    output = model(bags)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/app/abmil_assignment.py", line 29, in forward
    return self.bag_level_classifier(z)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (1x4 and 5x2)

----------------------------------------------------------------------
Ran 1 test in 0.014s

FAILED (errors=1)
root@328c598cd59e:/app# echo "        z = torch.sum(a * h, dim=1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        z = z.unsqueeze(1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# python3 -m unittest discover -s .; tmux wait -S done
Bags shape: torch.Size([4, 10])
h shape: torch.Size([4, 5])
a shape: torch.Size([4, 1])
z shape: torch.Size([4])
E
======================================================================
ERROR: test_forward (test_abmil.TestABMIL.test_forward)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/app/test_abmil.py", line 9, in test_forward
    output = model(bags)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/app/abmil_assignment.py", line 29, in forward
    return self.bag_level_classifier(z)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (1x4 and 5x2)

----------------------------------------------------------------------
Ran 1 test in 0.013s

FAILED (errors=1)
root@328c598cd59e:/app# echo "        a = a.view(-1, 1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        z = torch.sum(a * h, dim=1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        z = z.view(z.size(0), -1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# python3 -m unittest discover -s .; tmux wait -S done
Bags shape: torch.Size([4, 10])
h shape: torch.Size([4, 5])
a shape: torch.Size([4, 1])
z shape: torch.Size([4])
E
======================================================================
ERROR: test_forward (test_abmil.TestABMIL.test_forward)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/app/test_abmil.py", line 9, in test_forward
    output = model(bags)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/app/abmil_assignment.py", line 29, in forward
    return self.bag_level_classifier(z)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (1x4 and 5x2)

----------------------------------------------------------------------
Ran 1 test in 0.012s

FAILED (errors=1)
root@328c598cd59e:/app# echo "        a = a.squeeze(-1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        z = torch.sum(a * h, dim=1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        z = z.view(z.size(0), -1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# python3 -m unittest discover -s .; tmux wait -S done
Bags shape: torch.Size([4, 10])
h shape: torch.Size([4, 5])
a shape: torch.Size([4, 1])
z shape: torch.Size([4])
E
======================================================================
ERROR: test_forward (test_abmil.TestABMIL.test_forward)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/app/test_abmil.py", line 9, in test_forward
    output = model(bags)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/app/abmil_assignment.py", line 29, in forward
    return self.bag_level_classifier(z)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (1x4 and 5x2)

----------------------------------------------------------------------
Ran 1 test in 0.013s

FAILED (errors=1)
root@328c598cd59e:/app# echo "        a = a.squeeze(-1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        z = torch.sum(a * h, dim=1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        z = z.view(-1, 1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# python3 -m unittest discover -s .; tmux wait -S done
Bags shape: torch.Size([4, 10])
h shape: torch.Size([4, 5])
a shape: torch.Size([4, 1])
z shape: torch.Size([4])
E
======================================================================
ERROR: test_forward (test_abmil.TestABMIL.test_forward)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/app/test_abmil.py", line 9, in test_forward
    output = model(bags)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/app/abmil_assignment.py", line 29, in forward
    return self.bag_level_classifier(z)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (1x4 and 5x2)

----------------------------------------------------------------------
Ran 1 test in 0.010s

FAILED (errors=1)
root@328c598cd59e:/app# echo "        a = a.squeeze(-1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        z = torch.sum(a * h, dim=1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        z = z.view(-1, 1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# python3 -m unittest discover -s .; tmux wait -S done
Bags shape: torch.Size([4, 10])
h shape: torch.Size([4, 5])
a shape: torch.Size([4, 1])
z shape: torch.Size([4])
E
======================================================================
ERROR: test_forward (test_abmil.TestABMIL.test_forward)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/app/test_abmil.py", line 9, in test_forward
    output = model(bags)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/app/abmil_assignment.py", line 29, in forward
    return self.bag_level_classifier(z)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (1x4 and 5x2)

----------------------------------------------------------------------
Ran 1 test in 0.010s

FAILED (errors=1)
root@328c598cd59e:/app# echo "        a = a.view(-1, 1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        z = torch.sum(a * h, dim=1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        z = z.view(z.size(0), -1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# python3 -m unittest discover -s .; tmux wait -S done
Bags shape: torch.Size([4, 10])
h shape: torch.Size([4, 5])
a shape: torch.Size([4, 1])
z shape: torch.Size([4])
E
======================================================================
ERROR: test_forward (test_abmil.TestABMIL.test_forward)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/app/test_abmil.py", line 9, in test_forward
    output = model(bags)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/app/abmil_assignment.py", line 29, in forward
    return self.bag_level_classifier(z)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (1x4 and 5x2)

----------------------------------------------------------------------
Ran 1 test in 0.009s

FAILED (errors=1)
root@328c598cd59e:/app# echo "        z = torch.sum(a.squeeze(-1) * h, dim=1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        z = z.view(-1, 1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# python3 -m unittest discover -s .; tmux wait -S done
Bags shape: torch.Size([4, 10])
h shape: torch.Size([4, 5])
a shape: torch.Size([4, 1])
z shape: torch.Size([4])
E
======================================================================
ERROR: test_forward (test_abmil.TestABMIL.test_forward)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/app/test_abmil.py", line 9, in test_forward
    output = model(bags)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/app/abmil_assignment.py", line 29, in forward
    return self.bag_level_classifier(z)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (1x4 and 5x2)

----------------------------------------------------------------------
Ran 1 test in 0.010s

FAILED (errors=1)
root@328c598cd59e:/app# echo "        a = a.view(-1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        z = torch.sum(a * h, dim=1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        z = z.view(-1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# python3 -m unittest discover -s .; tmux wait -S done
Bags shape: torch.Size([4, 10])
h shape: torch.Size([4, 5])
a shape: torch.Size([4, 1])
z shape: torch.Size([4])
E
======================================================================
ERROR: test_forward (test_abmil.TestABMIL.test_forward)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/app/test_abmil.py", line 9, in test_forward
    output = model(bags)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/app/abmil_assignment.py", line 29, in forward
    return self.bag_level_classifier(z)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (1x4 and 5x2)

----------------------------------------------------------------------
Ran 1 test in 0.011s

FAILED (errors=1)
root@328c598cd59e:/app# echo "        z = torch.sum(a.squeeze() * h, dim=1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        z = z.view(-1, 1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# python3 -m unittest discover -s .; tmux wait -S done
Bags shape: torch.Size([4, 10])
h shape: torch.Size([4, 5])
a shape: torch.Size([4, 1])
z shape: torch.Size([4])
E
======================================================================
ERROR: test_forward (test_abmil.TestABMIL.test_forward)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/app/test_abmil.py", line 9, in test_forward
    output = model(bags)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/app/abmil_assignment.py", line 29, in forward
    return self.bag_level_classifier(z)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (1x4 and 5x2)

----------------------------------------------------------------------
Ran 1 test in 0.007s

FAILED (errors=1)
root@328c598cd59e:/app# echo "        z = torch.sum(a.squeeze() * h, dim=1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        z = z.view(z.size(0), -1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# python3 -m unittest discover -s .; tmux wait -S done
Bags shape: torch.Size([4, 10])
h shape: torch.Size([4, 5])
a shape: torch.Size([4, 1])
z shape: torch.Size([4])
E
======================================================================
ERROR: test_forward (test_abmil.TestABMIL.test_forward)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/app/test_abmil.py", line 9, in test_forward
    output = model(bags)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/app/abmil_assignment.py", line 29, in forward
    return self.bag_level_classifier(z)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (1x4 and 5x2)

----------------------------------------------------------------------
Ran 1 test in 0.009s

FAILED (errors=1)
root@328c598cd59e:/app# echo "        a = a.view(-1, 1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        z = torch.sum(a * h, dim=1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        return self.bag_level_classifier(z)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# python3 -m unittest discover -s .; tmux wait -S done
Bags shape: torch.Size([4, 10])
h shape: torch.Size([4, 5])
a shape: torch.Size([4, 1])
z shape: torch.Size([4])
E
======================================================================
ERROR: test_forward (test_abmil.TestABMIL.test_forward)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/app/test_abmil.py", line 9, in test_forward
    output = model(bags)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/app/abmil_assignment.py", line 29, in forward
    return self.bag_level_classifier(z)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (1x4 and 5x2)

----------------------------------------------------------------------
Ran 1 test in 0.006s

FAILED (errors=1)
root@328c598cd59e:/app# echo "        a = a.view(-1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        z = torch.sum(a * h, dim=1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        z = z.view(-1, 1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# python3 -m unittest discover -s .; tmux wait -S done
Bags shape: torch.Size([4, 10])
h shape: torch.Size([4, 5])
a shape: torch.Size([4, 1])
z shape: torch.Size([4])
E
======================================================================
ERROR: test_forward (test_abmil.TestABMIL.test_forward)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/app/test_abmil.py", line 9, in test_forward
    output = model(bags)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/app/abmil_assignment.py", line 29, in forward
    return self.bag_level_classifier(z)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (1x4 and 5x2)

----------------------------------------------------------------------
Ran 1 test in 0.007s

FAILED (errors=1)
root@328c598cd59e:/app# echo "        z = torch.sum(a.squeeze() * h, dim=1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        z = z.view(-1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# python3 -m unittest discover -s .; tmux wait -S done
Bags shape: torch.Size([4, 10])
h shape: torch.Size([4, 5])
a shape: torch.Size([4, 1])
z shape: torch.Size([4])
E
======================================================================
ERROR: test_forward (test_abmil.TestABMIL.test_forward)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/app/test_abmil.py", line 9, in test_forward
    output = model(bags)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/app/abmil_assignment.py", line 29, in forward
    return self.bag_level_classifier(z)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (1x4 and 5x2)

----------------------------------------------------------------------
Ran 1 test in 0.010s

FAILED (errors=1)
root@328c598cd59e:/app# echo "        z = torch.sum(a.squeeze() * h, dim=1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        z = z.view(-1, 1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# python3 -m unittest discover -s .; tmux wait -S done
Bags shape: torch.Size([4, 10])
h shape: torch.Size([4, 5])
a shape: torch.Size([4, 1])
z shape: torch.Size([4])
E
======================================================================
ERROR: test_forward (test_abmil.TestABMIL.test_forward)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/app/test_abmil.py", line 9, in test_forward
    output = model(bags)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/app/abmil_assignment.py", line 29, in forward
    return self.bag_level_classifier(z)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (1x4 and 5x2)

----------------------------------------------------------------------
Ran 1 test in 0.009s

FAILED (errors=1)
root@328c598cd59e:/app# echo "        z = torch.sum(a.squeeze() * h, dim=1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        z = z.view(z.size(0), -1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# python3 -m unittest discover -s .; tmux wait -S done
Bags shape: torch.Size([4, 10])
h shape: torch.Size([4, 5])
a shape: torch.Size([4, 1])
z shape: torch.Size([4])
E
======================================================================
ERROR: test_forward (test_abmil.TestABMIL.test_forward)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/app/test_abmil.py", line 9, in test_forward
    output = model(bags)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/app/abmil_assignment.py", line 29, in forward
    return self.bag_level_classifier(z)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (1x4 and 5x2)

----------------------------------------------------------------------
Ran 1 test in 0.009s

FAILED (errors=1)
root@328c598cd59e:/app# echo "        z = torch.sum(a.view(-1) * h, dim=1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        z = z.view(-1, 1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# python3 -m unittest discover -s .; tmux wait -S done
Bags shape: torch.Size([4, 10])
h shape: torch.Size([4, 5])
a shape: torch.Size([4, 1])
z shape: torch.Size([4])
E
======================================================================
ERROR: test_forward (test_abmil.TestABMIL.test_forward)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/app/test_abmil.py", line 9, in test_forward
    output = model(bags)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/app/abmil_assignment.py", line 29, in forward
    return self.bag_level_classifier(z)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (1x4 and 5x2)

----------------------------------------------------------------------
Ran 1 test in 0.009s

FAILED (errors=1)
root@328c598cd59e:/app# echo "        a = a.squeeze(-1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        z = torch.sum(a * h, dim=1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        z = z.view(z.size(0), -1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# python3 -m unittest discover -s .; tmux wait -S done
Bags shape: torch.Size([4, 10])
h shape: torch.Size([4, 5])
a shape: torch.Size([4, 1])
z shape: torch.Size([4])
E
======================================================================
ERROR: test_forward (test_abmil.TestABMIL.test_forward)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/app/test_abmil.py", line 9, in test_forward
    output = model(bags)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/app/abmil_assignment.py", line 29, in forward
    return self.bag_level_classifier(z)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (1x4 and 5x2)

----------------------------------------------------------------------
Ran 1 test in 0.009s

FAILED (errors=1)
root@328c598cd59e:/app# echo "        a = a.view(-1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        z = torch.sum(a * h, dim=1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        z = z.view(-1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# python3 -m unittest discover -s .; tmux wait -S done
Bags shape: torch.Size([4, 10])
h shape: torch.Size([4, 5])
a shape: torch.Size([4, 1])
z shape: torch.Size([4])
E
======================================================================
ERROR: test_forward (test_abmil.TestABMIL.test_forward)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/app/test_abmil.py", line 9, in test_forward
    output = model(bags)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/app/abmil_assignment.py", line 29, in forward
    return self.bag_level_classifier(z)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (1x4 and 5x2)

----------------------------------------------------------------------
Ran 1 test in 0.008s

FAILED (errors=1)
root@328c598cd59e:/app# echo "        a = a.view(-1, 1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        z = torch.sum(a * h, dim=1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        z = z.view(z.size(0), -1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# python3 -m unittest discover -s .; tmux wait -S done
Bags shape: torch.Size([4, 10])
h shape: torch.Size([4, 5])
a shape: torch.Size([4, 1])
z shape: torch.Size([4])
E
======================================================================
ERROR: test_forward (test_abmil.TestABMIL.test_forward)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/app/test_abmil.py", line 9, in test_forward
    output = model(bags)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/app/abmil_assignment.py", line 29, in forward
    return self.bag_level_classifier(z)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (1x4 and 5x2)

----------------------------------------------------------------------
Ran 1 test in 0.007s

FAILED (errors=1)
root@328c598cd59e:/app# echo "        z = torch.sum(a.view(-1) * h, dim=1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        z = z.view(-1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# python3 -m unittest discover -s .; tmux wait -S done
Bags shape: torch.Size([4, 10])
h shape: torch.Size([4, 5])
a shape: torch.Size([4, 1])
z shape: torch.Size([4])
E
======================================================================
ERROR: test_forward (test_abmil.TestABMIL.test_forward)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/app/test_abmil.py", line 9, in test_forward
    output = model(bags)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/app/abmil_assignment.py", line 29, in forward
    return self.bag_level_classifier(z)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (1x4 and 5x2)

----------------------------------------------------------------------
Ran 1 test in 0.007s

FAILED (errors=1)
root@328c598cd59e:/app# echo "        z = torch.sum(a.squeeze(-1) * h, dim=1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        z = z.view(z.size(0), -1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# python3 -m unittest discover -s .; tmux wait -S done
Bags shape: torch.Size([4, 10])
h shape: torch.Size([4, 5])
a shape: torch.Size([4, 1])
z shape: torch.Size([4])
E
======================================================================
ERROR: test_forward (test_abmil.TestABMIL.test_forward)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/app/test_abmil.py", line 9, in test_forward
    output = model(bags)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/app/abmil_assignment.py", line 29, in forward
    return self.bag_level_classifier(z)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (1x4 and 5x2)

----------------------------------------------------------------------
Ran 1 test in 0.007s

FAILED (errors=1)
root@328c598cd59e:/app# echo "        a = a.view(-1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        z = torch.sum(a * h, dim=1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        z = z.view(-1, 1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# python3 -m unittest discover -s .; tmux wait -S done
Bags shape: torch.Size([4, 10])
h shape: torch.Size([4, 5])
a shape: torch.Size([4, 1])
z shape: torch.Size([4])
E
======================================================================
ERROR: test_forward (test_abmil.TestABMIL.test_forward)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/app/test_abmil.py", line 9, in test_forward
    output = model(bags)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/app/abmil_assignment.py", line 29, in forward
    return self.bag_level_classifier(z)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (1x4 and 5x2)

----------------------------------------------------------------------
Ran 1 test in 0.007s

FAILED (errors=1)
root@328c598cd59e:/app# echo "        z = torch.sum(a.view(-1) * h, dim=1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        z = z.view(-1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# python3 -m unittest discover -s .; tmux wait -S done
Bags shape: torch.Size([4, 10])
h shape: torch.Size([4, 5])
a shape: torch.Size([4, 1])
z shape: torch.Size([4])
E
======================================================================
ERROR: test_forward (test_abmil.TestABMIL.test_forward)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/app/test_abmil.py", line 9, in test_forward
    output = model(bags)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/app/abmil_assignment.py", line 29, in forward
    return self.bag_level_classifier(z)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (1x4 and 5x2)

----------------------------------------------------------------------
Ran 1 test in 0.007s

FAILED (errors=1)
root@328c598cd59e:/app# echo "        a = a.squeeze(-1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        z = torch.sum(a * h, dim=1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        z = z.view(-1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# python3 -m unittest discover -s .; tmux wait -S done
Bags shape: torch.Size([4, 10])
h shape: torch.Size([4, 5])
a shape: torch.Size([4, 1])
z shape: torch.Size([4])
E
======================================================================
ERROR: test_forward (test_abmil.TestABMIL.test_forward)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/app/test_abmil.py", line 9, in test_forward
    output = model(bags)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/app/abmil_assignment.py", line 29, in forward
    return self.bag_level_classifier(z)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (1x4 and 5x2)

----------------------------------------------------------------------
Ran 1 test in 0.007s

FAILED (errors=1)
root@328c598cd59e:/app# echo "        z = torch.sum(a.view(-1) * h, dim=1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# echo "        z = z.view(-1, 1)" >> abmil_assignment.py; tmux wait -S done
root@328c598cd59e:/app# python3 -m unittest discover -s .; tmux wait -S done
Bags shape: torch.Size([4, 10])
h shape: torch.Size([4, 5])
a shape: torch.Size([4, 1])
z shape: torch.Size([4])
E
======================================================================
ERROR: test_forward (test_abmil.TestABMIL.test_forward)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/app/test_abmil.py", line 9, in test_forward
    output = model(bags)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/app/abmil_assignment.py", line 29, in forward
    return self.bag_level_classifier(z)
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.13/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (1x4 and 5x2)

----------------------------------------------------------------------
Ran 1 test in 0.007s

FAILED (errors=1)
root@328c598cd59e:/app#
