1      1  Unfortunately, the frustration of being Dr. Go...
2      3  Been going to Dr. Goldberg for over 10 years. ...
3      3  Got a letter in the mail last week that said D...
4      0  I don't know what Dr. Goldberg was like before...
root@81a07da8a584:/app/data/fastText# python3 -c "import pandas as pd; df = pd.read_parquet('/app/data/train-00000-of-00001.parquet'); df['label'] = '__label__'
 + df['rating'].astype(str); df['text'] = df['review']; df[['label', 'text']].to_csv('/app/data/yelp_data_formatted.txt', index=False, header=False, sep=' ');";
 tmux wait -S done
Traceback (most recent call last):
  File "/usr/local/lib/python3.13/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'rating'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "<string>", line 1, in <module>
    import pandas as pd; df = pd.read_parquet('/app/data/train-00000-of-00001.parquet'); df['label'] = '__label__' + df['rating'].astype(str); df['text'] = df['
review']; df[['label', 'text']].to_csv('/app/data/yelp_data_formatted.txt', index=False, header=False, sep=' ');
                                                                                                                     ~~^^^^^^^^^^
  File "/usr/local/lib/python3.13/site-packages/pandas/core/frame.py", line 4107, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/usr/local/lib/python3.13/site-packages/pandas/core/indexes/base.py", line 3819, in get_loc
    raise KeyError(key) from err
KeyError: 'rating'
root@81a07da8a584:/app/data/fastText# ls -la /app/data; tmux wait -S done
total 764548
drwxr-xr-x  1 root root      4096 Jul 14 23:59 .
drwxr-xr-x  1 root root      4096 Jul 11 19:37 ..
drwxr-xr-x 12 root root      4096 Jul 15 00:00 fastText
-rw-r--r--  1 root root   4844861 Jul 11 19:37 test-00000-of-00001.parquet
-rw-r--r--  1 root root 299436850 Jan  4  2024 train-00000-of-00001.parquet
-rw-r--r--  1 root root 478585060 Jul 14 23:58 yelp_data.txt
root@81a07da8a584:/app/data/fastText# cat /app/data/yelp_data_formatted.txt | head -n 10; tmux wait -S done
cat: /app/data/yelp_data_formatted.txt: No such file or directory
root@81a07da8a584:/app/data/fastText#
