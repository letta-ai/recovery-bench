                       END-IF
               END-READ
           END-PERFORM
           CLOSE BOOKS-FILE

           OPEN EXTEND TRANSACTIONS-FILE
           MOVE WS-BUYER-ID TO TRANS-BUYER
           MOVE WS-SELLER-ID TO TRANS-SELLER
           MOVE WS-BOOK-ID TO TRANS-BOOK
           MOVE WS-AMOUNT TO TRANS-AMOUNT
           WRITE TRANSACTION-RECORD
           CLOSE TRANSACTIONS-FILE

           DISPLAY "Transaction completed successfully".
root@db1fd379f47c:/app# echo "def process_transactions(data):" >> /app/program.py; tmux wait -S done
root@db1fd379f47c:/app# echo "    WS_BUYER_ID, WS_SELLER_ID, WS_AMOUNT, WS_BOOK_ID = data.split(',')" >> /app/program.py; tmux wait -S done
root@db1fd379f47c:/app# echo "    # Update ACCOUNTS.DAT" >> /app/program.py; tmux wait -S done
root@db1fd379f47c:/app# echo "    with open('/app/data/ACCOUNTS.DAT', 'r+') as accounts_file:" >> /app/program.py; tmux wait -S done
root@db1fd379f47c:/app# echo "        accounts = accounts_file.readlines()" >> /app/program.py; tmux wait -S done
root@db1fd379f47c:/app# echo "        for account in accounts:" >> /app/program.py; tmux wait -S done
root@db1fd379f47c:/app# echo "            ACCOUNT_ID, ACCOUNT_BALANCE = account.split(',')" >> /app/program.py; tmux wait -S done
root@db1fd379f47c:/app# echo "            if ACCOUNT_ID == WS_BUYER_ID:" >> /app/program.py; tmux wait -S done
root@db1fd379f47c:/app# echo "                ACCOUNT_BALANCE = str(float(ACCOUNT_BALANCE) - float(WS_AMOUNT))" >> /app/program.py; tmux wait -S done
root@db1fd379f47c:/app# echo "                accounts_file.write(f'{ACCOUNT_ID},{ACCOUNT_BALANCE}\n')" >> /app/program.py; tmux wait -S done
root@db1fd379f47c:/app# echo "            elif ACCOUNT_ID == WS_SELLER_ID:" >> /app/program.py; tmux wait -S done
root@db1fd379f47c:/app# echo "                ACCOUNT_BALANCE = str(float(ACCOUNT_BALANCE) + float(WS_AMOUNT))" >> /app/program.py; tmux wait -S done
root@db1fd379f47c:/app# echo "                accounts_file.write(f'{ACCOUNT_ID},{ACCOUNT_BALANCE}\n')" >> /app/program.py; tmux wait -S done
root@db1fd379f47c:/app# echo "    # Update BOOKS.DAT" >> /app/program.py; tmux wait -S done
root@db1fd379f47c:/app# echo "    with open('/app/data/BOOKS.DAT', 'r+') as books_file:" >> /app/program.py; tmux wait -S done
root@db1fd379f47c:/app# echo "        books = books_file.readlines()" >> /app/program.py; tmux wait -S done
root@db1fd379f47c:/app# echo "        for book in books:" >> /app/program.py; tmux wait -S done
root@db1fd379f47c:/app# echo "            BOOK_ID, BOOK_OWNER = book.split(',')" >> /app/program.py; tmux wait -S done
root@db1fd379f47c:/app# echo "            if BOOK_ID == WS_BOOK_ID:" >> /app/program.py; tmux wait -S done
root@db1fd379f47c:/app# echo "                BOOK_OWNER = WS_BUYER_ID" >> /app/program.py; tmux wait -S done
root@db1fd379f47c:/app# echo "                books_file.write(f'{BOOK_ID},{BOOK_OWNER}\n')" >> /app/program.py; tmux wait -S done
root@db1fd379f47c:/app# echo "    # Log to TRANSACTIONS.DAT" >> /app/program.py; tmux wait -S done
root@db1fd379f47c:/app# echo "    with open('/app/data/TRANSACTIONS.DAT', 'a') as transactions_file:" >> /app/program.py; tmux wait -S done
root@db1fd379f47c:/app# echo "        transactions_file.write(f'{WS_BUYER_ID},{WS_SELLER_ID},{WS_BOOK_ID},{WS_AMOUNT}\n')" >> /app/program.py; tmux wait -S done
root@db1fd379f47c:/app# echo "    print('Transaction completed successfully')" >> /app/program.py; tmux wait -S done
root@db1fd379f47c:/app#
