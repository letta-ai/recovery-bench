(venv) root@54140e178f79:/app# echo "flows = []\nif packet.haslayer(scapy.IP):\n    flow_key = (packet[scapy.IP].src, packet[scapy.IP].dst)\n    if flow_key not
 in flows:\n        flows[flow_key] = []\n    flows[flow_key].append(packet)" > /app/temp_script.py
(venv) root@54140e178f79:/app# cat /app/temp_script.py >> /app/pcap_to_netflow.py
(venv) root@54140e178f79:/app# rm /app/temp_script.py
(venv) root@54140e178f79:/app# python /app/pcap_to_netflow.py /path/to/sample.pcap /path/to/output_dir; tmux wait -S done
  File "/app/pcap_to_netflow.py", line 18
    flows = []  if packet.haslayer(scapy.IP):
                                            ^
SyntaxError: invalid syntax
(venv) root@54140e178f79:/app# nano /app/pcap_to_netflow.py; tmux wait -S done
bash: nano: command not found
(venv) root@54140e178f79:/app# echo "flows = []" > /app/pcap_to_netflow.py
(venv) root@54140e178f79:/app# echo "if packet.haslayer(scapy.IP):" >> /app/pcap_to_netflow.py
(venv) root@54140e178f79:/app# echo "    flow_key = (packet[scapy.IP].src, packet[scapy.IP].dst)" >> /app/pcap_to_netflow.py
(venv) root@54140e178f79:/app# echo "    if flow_key not in flows:" >> /app/pcap_to_netflow.py
(venv) root@54140e178f79:/app# echo "        flows[flow_key] = []" >> /app/pcap_to_netflow.py
(venv) root@54140e178f79:/app# echo "    flows[flow_key].append(packet)" >> /app/pcap_to_netflow.py
(venv) root@54140e178f79:/app# echo "for flow_key, packets in flows.items():" >> /app/pcap_to_netflow.py
(venv) root@54140e178f79:/app# echo "    netflow_data = b'\x00'" >> /app/pcap_to_netflow.py
(venv) root@54140e178f79:/app# echo "    with open(os.path.join(output_dir, f'\{flow_key[0]}-{flow_key[1]}.netflow'), 'wb') as f:" >> /app/pcap_to_netflow.py
(venv) root@54140e178f79:/app# echo "        f.write(netflow_data)" >> /app/pcap_to_netflow.py
(venv) root@54140e178f79:/app# python /app/pcap_to_netflow.py /path/to/sample.pcap /path/to/output_dir; tmux wait -S done
/app/pcap_to_netflow.py:9: SyntaxWarning: invalid escape sequence '\{'
  with open(os.path.join(output_dir, f'\{flow_key[0]}-{flow_key[1]}.netflow'), 'wb') as f:
Traceback (most recent call last):
  File "/app/pcap_to_netflow.py", line 2, in <module>
    if packet.haslayer(scapy.IP):
       ^^^^^^
NameError: name 'packet' is not defined
(venv) root@54140e178f79:/app# sed -i '1s/^/fl = scapy.rdpcap(input_file)\n/' /app/pcap_to_netflow.py
(venv) root@54140e178f79:/app# sed -i 's/f\\{flow_key[0]}-/{flow_key[0]}-/g' /app/pcap_to_netflow.py
(venv) root@54140e178f79:/app# python /app/pcap_to_netflow.py /path/to/sample.pcap /path/to/output_dir; tmux wait -S done
/app/pcap_to_netflow.py:10: SyntaxWarning: invalid escape sequence '\{'
  with open(os.path.join(output_dir, f'\{flow_key[0]}-{flow_key[1]}.netflow'), 'wb') as f:
Traceback (most recent call last):
  File "/app/pcap_to_netflow.py", line 1, in <module>
    fl = scapy.rdpcap(input_file)
         ^^^^^
NameError: name 'scapy' is not defined
(venv) root@54140e178f79:/app#
