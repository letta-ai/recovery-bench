NameError: name 'scapy' is not defined
(venv) root@54140e178f79:/app# sed -i '1s/^/import scapy.all as scapy\n/' /app/pcap_to_netflow.py
(venv) root@54140e178f79:/app# sed -i 's/f\\{flow_key[0]}-/f{flow_key[0]}-/g' /app/pcap_to_netflow.py
(venv) root@54140e178f79:/app# python /app/pcap_to_netflow.py /path/to/sample.pcap /path/to/output_dir; tmux wait -S done
/app/pcap_to_netflow.py:11: SyntaxWarning: invalid escape sequence '\{'
  with open(os.path.join(output_dir, f'\{flow_key[0]}-{flow_key[1]}.netflow'), 'wb') as f:
Traceback (most recent call last):
  File "/app/pcap_to_netflow.py", line 2, in <module>
    fl = scapy.rdpcap(input_file)
                      ^^^^^^^^^^
NameError: name 'input_file' is not defined
(venv) root@54140e178f79:/app# sed -i '1s/^/import scapy.all as scapy\ninput_file = sys.argv[1]\noutput_dir = sys.argv[2]\n/' /app/pcap_to_netflow.py
(venv) root@54140e178f79:/app# sed -i 's/f\\{flow_key[0]}-/f{flow_key[0]}-/g' /app/pcap_to_netflow.py
(venv) root@54140e178f79:/app# python /app/pcap_to_netflow.py /path/to/sample.pcap /path/to/output_dir; tmux wait -S done
/app/pcap_to_netflow.py:14: SyntaxWarning: invalid escape sequence '\{'
  with open(os.path.join(output_dir, f'\{flow_key[0]}-{flow_key[1]}.netflow'), 'wb') as f:
Traceback (most recent call last):
  File "/app/pcap_to_netflow.py", line 2, in <module>
    input_file = sys.argv[1]
                 ^^^
NameError: name 'sys' is not defined. Did you forget to import 'sys'?
(venv) root@54140e178f79:/app# sed -i '1s/^/import sys\n/' /app/pcap_to_netflow.py
(venv) root@54140e178f79:/app# sed -i 's/f\\{flow_key[0]}-/f{flow_key[0]}-/g' /app/pcap_to_netflow.py
(venv) root@54140e178f79:/app# python /app/pcap_to_netflow.py /path/to/sample.pcap /path/to/output_dir; tmux wait -S done
/app/pcap_to_netflow.py:15: SyntaxWarning: invalid escape sequence '\{'
  with open(os.path.join(output_dir, f'\{flow_key[0]}-{flow_key[1]}.netflow'), 'wb') as f:
Traceback (most recent call last):
  File "/app/pcap_to_netflow.py", line 6, in <module>
    fl = scapy.rdpcap(input_file)
         ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/venv/lib/python3.12/site-packages/scapy/utils.py", line 1345, in rdpcap
    with PcapReader(filename) as fdesc:  # type: ignore
         ^^^^^^^^^^^^^^^^^^^^
  File "/app/venv/lib/python3.12/site-packages/scapy/utils.py", line 1410, in __call__
    raise Scapy_Exception("Not a supported capture file")
scapy.error.Scapy_Exception: Not a supported capture file
(venv) root@54140e178f79:/app# ls -la /path/to/sample.pcap; tmux wait -S done
-rw-r--r-- 1 root root 35 Jul 15 01:21 /path/to/sample.pcap
(venv) root@54140e178f79:/app# mkdir -p /path/to/output_dir
(venv) root@54140e178f79:/app#
